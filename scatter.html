<!DOCTYPE html>
<html>

<head>
    <link rel="stylesheet" href="./chart.css">
</head>

<body>
    <script src="https://cdn.freecodecamp.org/testable-projects-fcc/v1/bundle.js"></script>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <div id="container">
        <div id="title">United States GDP</div>
        <div id="chart"></div>
        <div id="tooltip">This is tooltip</div>
    </div>
    <script>
        const height = 460
        const width = 900
        const padding = 50

        const chart = d3.select("body").select("#container").select("#chart")
        const tooltip = d3.select("body").select("#tooltip")

        const dataUrl = "https://raw.githubusercontent.com/freeCodeCamp/ProjectReferenceData/master/cyclist-data.json"

        window.onload = () => {
            fetch(dataUrl)
                .then(response => response.json())
                .then(data => {
                    initChart(data)
                })
                .catch(error => {
                    console.error('Error:', error);
                });
        }

        const initChart = (data) => {
            // This is time like "1949-04-01"

            const years = data.map(each => {
                return d3.timeParse("%Y")(each["Year"])
            })
            const durations = data.map(each => {
                return d3.timeParse("%M:%S")(each["Time"])
            })

            debugger

            const xScale = d3.scaleTime()
                .domain(d3.extent(years))
                .range([padding, width - padding])

            const yScale = d3.scaleTime()
                .domain(d3.extent(durations))
                .range([padding, height - padding])

            const svg = chart.append("svg")

            svg.attr("width", width).attr("height", height)

            const xAxis = d3.axisBottom(xScale)
            const yAxis = d3.axisLeft(yScale).tickFormat(d => {
                let seconds = d.getSeconds()
                if(seconds === 0){
                    return d.getMinutes() + ":00"
                }
                
                return d.getMinutes() + ":" + d.getSeconds()
            });

            svg.append("g")
                .attr("id", "x-axis")
                .attr("transform", "translate(0," + (height - padding) + ")")
                .call(xAxis);
            svg.append("g")
                .attr("id", "y-axis")
                .attr("transform", "translate(" + padding + ",0)")
                .call(yAxis)
        }
    </script>
</body>

</html>